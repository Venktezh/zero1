<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Minesweeper | ClearCache Game</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
:root {
    --primary: #34495e;
    --secondary: #7f8c8d;
    --accent: #3498db;
    --accent-dark: #2980b9;
}
body { background: #f6f7f9; font-family: 'Segoe UI', 'Roboto', Arial, sans-serif; margin:0; }
header { text-align: center; margin-top: 2.3rem; }
header h1 { font-size: 2.3rem; font-weight: 600; color: var(--primary); margin-bottom: 0.25rem; }
header .tagline { color: var(--secondary); font-size: 1.07rem; margin: 0; }
nav { margin: 2.2rem auto 0 auto; display: flex; justify-content: center; }
.nav-container { display: flex; gap: 1rem; }
.nav-item { padding: 0.7rem 2.1rem; border: 1px solid #e3e8ee; border-radius: 0.6rem; background: #fff; color: var(--primary); text-decoration: none; font-weight: 500; transition: background 0.15s, color 0.15s;}
.nav-item.active, .nav-item:focus, .nav-item:hover { background: var(--primary); color: #fff; outline: none; border-color: var(--primary);}
.center {text-align:center;}
#mine-container { display: flex; flex-direction: column; align-items: center; margin: 1.5em 0 0 0; }
#game-options { margin: 0 0 1.3em 0; display: flex; gap: 1em; align-items: center; justify-content: center; flex-wrap:wrap;}
.board { display: grid; gap:0; background: #cccccc; border-radius: 7px; border:2px solid #444; box-shadow: 0 1px 10px #0001;}
.cell {
    width: 2em; height: 2em; text-align: center; vertical-align: middle;
    border: 1px solid #bbb; background: #e4e4e6;
    font-size: 1.25em; font-family: inherit;
    user-select: none; cursor: pointer;
    transition: background 0.13s;
    padding: 0;
}
.cell.revealed {
    background: #fafcff;
    border-color: #aaa;
    cursor: default;
}
.cell.mine {
    background: #ecd6d8 !important;
}
.cell.flagged {
    background: #f9f4c0;
    color: #c0392b;
}
.cell:disabled { cursor: default; }
.cell.mine.revealed { color: #c0392b; }
.num1 { color: #1a85e8;}
.num2 { color: #3d990a;}
.num3 { color: #e8a91a;}
.num4 { color: #e2381a;}
.num5 { color: #425969;}
.num6 { color: #8774e3;}
.num7 { color: #bb1ae8;}
.num8 { color: #13191d;}
.btn {
    background: #3498db; color: #fff; border: none; border-radius: .4em;
    padding: .6em 1.6em; font-size: 1em; font-family: inherit;
    cursor: pointer; margin: 0 .25em;
    transition: background 0.15s;
}
.btn:active, .btn:focus, .btn:hover { background: #2980b9; }
#status { margin-top: 1.07em; font-weight: 500; }
#mine-count { margin-left: 1.5em; font-weight: 700; color: #e2381a;}
@media (max-width: 600px) {
    .nav-container { gap:0.45rem; flex-wrap:wrap;}
    nav { margin-top: 1rem;}
    header h1 { font-size: 1.4rem; }
    .board { border-radius: 3px;}
    .cell { width: 1.5em; height: 1.5em; }
}
</style>
</head>
<body>
<header>
    <h1>ClearCache</h1>
    <p class="tagline">Minimal digital workspace</p>
</header>
<nav aria-label="Main navigation">
    <div class="nav-container">
        <a href="index.html" class="nav-item">Home</a>
        <a href="about.html" class="nav-item">About</a>
        <a href="contact.html" class="nav-item">Contact</a>
        <a href="game.html" class="nav-item active">Game</a>
    </div>
</nav>
<h2 class="center" style="margin-top:2em; color:#34495e;">Minesweeper</h2>
<div id="mine-container">
    <div id="game-options">
        <span>Level:</span>
        <select id="difficulty">
            <option value="easy">Easy (9x9, 10 mines)</option>
            <option value="medium">Medium (16x16, 40 mines)</option>
            <option value="hard">Hard (16x30, 99 mines)</option>
        </select>
        <button class="btn" onclick="newGame()">New Game</button>
        <span id="mine-count"></span>
    </div>
    <div id="board-wrap">
        <div id="board"></div>
    </div>
    <div id="status" class="center"></div>
</div>
<script>
const levels = {
    easy:   {rows: 9, cols: 9, mines: 10},
    medium: {rows: 16, cols: 16, mines: 40},
    hard:   {rows: 16, cols: 30, mines: 99}
};
let board = [];
let revealed = [];
let flagged = [];
let gameOver = false;
let started = false;
let minesLeft = 0;
let config = {...levels.easy};
let rows = 9, cols = 9, mines = 10;

function newGame() {
    // Get settings
    config = levels[document.getElementById('difficulty').value];
    rows = config.rows; cols = config.cols; mines = config.mines;
    // Clear
    board = Array.from({length: rows}, () => Array(cols).fill(0));
    revealed = Array.from({length: rows}, () => Array(cols).fill(false));
    flagged = Array.from({length: rows}, () => Array(cols).fill(false));
    gameOver = false;
    started = false;
    minesLeft = mines;
    document.getElementById('status').textContent = '';
    document.getElementById('mine-count').textContent = `ðŸ’£ ${minesLeft}`;
    drawBoard();
}
function drawBoard() {
    const wrap = document.getElementById('board-wrap');
    const boardDiv = document.getElementById('board');
    boardDiv.innerHTML = '';
    boardDiv.className = 'board';
    boardDiv.style.gridTemplateColumns = `repeat(${cols},1fr)`;
    boardDiv.style.gridTemplateRows = `repeat(${rows},1fr)`;
    for(let r=0; r<rows; r++) for(let c=0; c<cols; c++) {
        const cell = document.createElement('button');
        cell.className = 'cell';
        cell.dataset.r = r;
        cell.dataset.c = c;
        cell.addEventListener('click', cellClick);
        cell.addEventListener('contextmenu', cellFlag);
        boardDiv.appendChild(cell);
    }
}
function placeMines(safeR, safeC) {
    let placed = 0;
    let safeCells = new Set();
    // Don't put mine in first open cell or neighbors
    for(let dr=-1; dr<=1; dr++) for(let dc=-1; dc<=1; dc++)
        if (valid(safeR+dr, safeC+dc)) safeCells.add(`${safeR+dr},${safeC+dc}`);
    while (placed < mines) {
        let r = Math.floor(Math.random() * rows), c = Math.floor(Math.random() * cols);
        if (board[r][c] === 'M') continue;
        if (safeCells.has(`${r},${c}`)) continue; // So first click is always safe
        board[r][c] = 'M';
        placed++;
    }
    // Fill numbers
    for(let r=0; r<rows; r++) for(let c=0; c<cols; c++) {
        if (board[r][c]=='M') continue;
        let cnt = 0;
        for(let dr=-1; dr<=1; dr++) for(let dc=-1; dc<=1; dc++)
            if (valid(r+dr,c+dc) && board[r+dr][c+dc]=='M') cnt++;
        board[r][c] = cnt;
    }
}
function cellClick(e) {
    e.preventDefault();
    if (gameOver) return;
    const r = +this.dataset.r, c = +this.dataset.c;
    if (!started) { placeMines(r, c); started = true; }
    if (flagged[r][c] || revealed[r][c]) return;
    reveal(r,c);
    checkWin();
}
function cellFlag(e) {
    e.preventDefault();
    if (gameOver) return;
    const r = +this.dataset.r, c = +this.dataset.c;
    if (revealed[r][c]) return;
    flagged[r][c] = !flagged[r][c];
    updateCell(r, c);
    // Update mine count
    let flagsUsed = flagged.flat().filter(Boolean).length;
    document.getElementById('mine-count').textContent = `ðŸ’£ ${minesLeft - flagsUsed}`;
    checkWin();
}
function reveal(r, c) {
    if (!valid(r, c) || flagged[r][c] || revealed[r][c]) return;
    revealed[r][c] = true;
    updateCell(r, c);
    if (board[r][c] === 'M') {
        endGame(false, r, c);
        return;
    }
    // If zero, flood fill
    if (board[r][c] === 0) {
        for(let dr=-1; dr<=1; dr++) for(let dc=-1; dc<=1; dc++)
            if (dr!==0||dc!==0) reveal(r+dr, c+dc);
    }
}
function updateCell(r, c) {
    const i = r*cols+c;
    const btn = document.getElementsByClassName('cell')[i];
    btn.disabled = revealed[r][c] || gameOver;
    btn.classList.remove('revealed','mine','flagged','num1','num2','num3','num4','num5','num6','num7','num8');
    btn.textContent = '';
    if (flagged[r][c] && !revealed[r][c]) {
        btn.classList.add('flagged');
        btn.textContent = "ðŸš©";
        return;
    }
    if (revealed[r][c]) {
        btn.classList.add('revealed');
        if (board[r][c]=='M') {
            btn.classList.add('mine');
            btn.textContent = "ðŸ’£";
        } else if (board[r][c]>0) {
            btn.textContent = board[r][c];
            btn.classList.add('num' + board[r][c]);
        }
    }
}
function valid(r, c) { return r>=0 && c>=0 && r<rows && c<cols; }
function endGame(won, explodedR=null, explodedC=null) {
    gameOver = true;
    for(let r=0;r<rows;r++) for(let c=0;c<cols;c++) {
        if (revealed[r][c] || (won && board[r][c] != 'M')) continue;
        flagged[r][c] = (board[r][c]=='M');
        revealed[r][c] = true;
        updateCell(r, c);
    }
    if (!won && explodedR!=null && explodedC!=null) {
        document.getElementsByClassName('cell')[explodedR*cols+explodedC].style.background='#ffadad';
    }
    document.getElementById('status').textContent = won ? "ðŸŽ‰ You cleared the board! Start new game for next level." : "ðŸ’¥ Game Over! Try new game for another level.";
}
function checkWin() {
    // Win if all non-mine cells are revealed
    let win = true;
    for(let r=0;r<rows;r++) for(let c=0;c<cols;c++)
        if (board[r][c]!='M' && !revealed[r][c]) win = false;
    if (win) endGame(true);
}
// Redraw all cells
function redrawAll() {
    for(let r=0;r<rows;r++) for(let c=0;c<cols;c++) updateCell(r,c);
}
document.getElementById('difficulty').addEventListener('change', newGame);
window.newGame = newGame; // for button
// On load
newGame();
</script>
</body>
</html>
